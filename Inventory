from Tkinter import *
import tkMessageBox
import Tkinter

def get_letters():
    import csv
    import fileinput
    import os
    win=Tk()
    inventorylist = "C:/Users/Rebecca/Desktop/Overland/Ordering Guide.csv"
    brands = csv.reader(open(inventorylist))
    alphab=["Menu"]
    for brand in brands:
        alpha = brand[0][0]
        if alpha not in alphab:
            alphab.append(alpha)
        print alphab
    for letter in alphab:        
        newButtons=Tkinter.Button(win,text=letter)
        newButtons.pack()
        win.title("Overland Inventory")

    mainloop()

get_letters()


#more simple for now

import csv
import fileinput
import os
from datetime import datetime
#import xlwt
    
def get_letters():
    inventorylist = "C:/Users/rmorganstern/Desktop/PY/Overland/Ordering Guide.csv"
    brands = csv.reader(open(inventorylist))
    alphab=["X"]
    for brand in brands:
        alpha = brand[0][0]
        if alpha not in alphab:
            alphab.append(alpha)
    alphab.sort()
    print alphab
    letter = raw_input('Enter your brand letter: ')
    l=str(letter).upper()
    if l=="X" or l=="x":
        quit
    else:
        get_bottles(l)
        

def get_bottles(l):
    bottles=["X"]
    inventorylist = "C:/Users/rmorganstern/Desktop/PY/Overland/Ordering Guide.csv"
    brands = csv.reader(open(inventorylist))
    cdate = datetime.today()
    file = "C:/Users/rmorganstern/Desktop/PY/Overland/Balance_Report/"+str(format(cdate,"%Y-%m-%d"))+".csv"
    balrep = open(file,"w+")
    for brand in brands:
        alpha = brand[0][0]
        if alpha == l or alpha == l.lower():
            bottles.append(brand)
    for number, letter in enumerate(bottles,0):
        print'{}{}'.format(number, letter)
    bottleindex = raw_input ('Enter bottle number: ')
    if bottleindex=="0" or bottleindex=="X" or bottleindex=="x":
        get_letters()
        exit
    bottle = bottles[int(bottleindex)]
    weightval = raw_input('Enter bottle weight: ')
    with open(file, 'a') as balrep:
       balrep.write("\n"+str(bottle)+"\t,"+weightval)
       balrep.close()
    



get_letters()
